<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Server Health Monitor</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Custom CSS -->
    <style>
        body {
            background-color: #f4f6f9;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .dashboard-card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s;
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
        }

        .card-icon {
            font-size: 2.5rem;
            opacity: 0.8;
        }

        .progress {
            height: 25px;
            border-radius: 12px;
            background-color: #e9ecef;
        }

        .progress-bar {
            font-size: 0.9rem;
            font-weight: bold;
            line-height: 25px;
            transition: width 0.6s ease;
        }

        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85rem;
        }

        .bg-gradient-primary {
            background: linear-gradient(45deg, #4e73df, #224abe);
            color: white;
        }

        .metric-value {
            font-size: 2rem;
            font-weight: 700;
            color: #333;
        }

        .metric-label {
            font-size: 0.9rem;
            color: #6c757d;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Status Colors */
        .status-good {
            color: #1cc88a;
        }

        .status-warning {
            color: #f6c23e;
        }

        .status-danger {
            color: #e74a3b;
        }
    </style>
</head>

<body>

    <nav class="navbar navbar-dark bg-dark mb-4">
        <div class="container">
            <a class="navbar-brand" href="#"><i class="fas fa-server me-2"></i>PlotPro Health Monitor</a>
            <span class="text-light small" id="last-updated">Updating...</span>
        </div>
    </nav>

    <div class="container">
        <!-- Alert Section -->
        <div id="alert-box" class="alert alert-danger d-none mb-4 shadow-sm">
            <i class="fas fa-exclamation-triangle me-2"></i> <strong>Warning:</strong> <span id="alert-msg"></span>
        </div>

        <div class="row g-4">
            <!-- CPU Card -->
            <div class="col-md-4">
                <div class="card dashboard-card h-100">
                    <div class="card-body text-center p-4">
                        <div class="mb-3 text-primary"><i class="fas fa-microchip card-icon"></i></div>
                        <h5 class="card-title text-muted mb-4">Processor (CPU)</h5>
                        <div class="metric-value mb-2" id="cpu-val">0%</div>
                        <div class="progress mb-3">
                            <div id="cpu-bar" class="progress-bar bg-success" role="progressbar" style="width: 0%">0%
                            </div>
                        </div>
                        <p class="small text-muted" id="cpu-msg">Optimal Load</p>
                    </div>
                </div>
            </div>

            <!-- RAM Card -->
            <div class="col-md-4">
                <div class="card dashboard-card h-100">
                    <div class="card-body text-center p-4">
                        <div class="mb-3 text-success"><i class="fas fa-memory card-icon"></i></div>
                        <h5 class="card-title text-muted mb-4">Memory (RAM)</h5>
                        <div class="metric-value mb-2" id="ram-val">0%</div>
                        <div class="progress mb-3">
                            <div id="ram-bar" class="progress-bar bg-success" role="progressbar" style="width: 0%">0%
                            </div>
                        </div>
                        <p class="small text-muted" id="ram-msg">Plenty of space</p>
                    </div>
                </div>
            </div>

            <!-- Disk Card -->
            <div class="col-md-4">
                <div class="card dashboard-card h-100">
                    <div class="card-body text-center p-4">
                        <div class="mb-3 text-info"><i class="fas fa-hdd card-icon"></i></div>
                        <h5 class="card-title text-muted mb-4">Hard Disk</h5>
                        <div class="metric-value mb-2" id="disk-val">0%</div>
                        <div class="progress mb-3">
                            <div id="disk-bar" class="progress-bar bg-info" role="progressbar" style="width: 0%">0%
                            </div>
                        </div>
                        <p class="small text-muted" id="disk-msg">Storage Status</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recommendations Section -->
        <div class="row mt-5">
            <div class="col-12">
                <div class="card shadow-sm border-0">
                    <div class="card-header bg-white py-3">
                        <h6 class="m-0 font-weight-bold text-primary"><i class="fas fa-info-circle me-1"></i> What does
                            this mean?</h6>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <h6 class="fw-bold text-dark">Processor (CPU)</h6>
                                <p class="small text-muted">Thinking Power. If this hits <strong>100%</strong>, the
                                    website becomes slow. This usually happens when generating many PDFs at once.</p>
                            </div>
                            <div class="col-md-4 mb-3">
                                <h6 class="fw-bold text-dark">Memory (RAM)</h6>
                                <p class="small text-muted">Workspace. If this is full, the server might crash. Green
                                    means you have plenty of room for more users.</p>
                            </div>
                            <div class="col-md-4 mb-3">
                                <h6 class="fw-bold text-dark">Hard Disk</h6>
                                <p class="small text-muted">Storage. Where PDFs and Database live. If this is full, you
                                    cannot save new data.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function updateStats() {
            fetch('/api/server-stats')
                .then(response => response.json())
                .then(data => {
                    // Update CPU
                    updateCard('cpu', data.cpu, 80);

                    // Update RAM
                    updateCard('ram', data.ram, 90);

                    // Update Disk
                    updateCard('disk', data.disk, 90);

                    // Update Time
                    const now = new Date();
                    document.getElementById('last-updated').innerText = 'Last Updated: ' + now.toLocaleTimeString();

                    // Alert Logic
                    const alertBox = document.getElementById('alert-box');
                    if (data.cpu > 85 || data.ram > 90 || data.disk > 95) {
                        alertBox.classList.remove('d-none');
                        document.getElementById('alert-msg').innerText = "High Resource Usage Detected! Check components immediately.";
                    } else {
                        alertBox.classList.add('d-none');
                    }
                })
                .catch(err => console.error('Failed to fetch stats:', err));
        }

        function updateCard(id, value, threshold) {
            const bar = document.getElementById(id + '-bar');
            const valText = document.getElementById(id + '-val');
            const msg = document.getElementById(id + '-msg');

            // Values
            valText.innerText = value + '%';
            bar.style.width = value + '%';
            bar.innerText = value + '%';

            // Color Logic
            bar.className = 'progress-bar'; // Reset
            if (value < 50) {
                bar.classList.add('bg-success');
                msg.innerText = "Good Status";
                msg.className = "small text-success fw-bold";
            } else if (value < threshold) {
                bar.classList.add('bg-warning');
                bar.classList.add('text-dark');
                msg.innerText = "Moderate Load";
                msg.className = "small text-warning fw-bold";
            } else {
                bar.classList.add('bg-danger');
                msg.innerText = "Critical Warning!";
                msg.className = "small text-danger fw-bold";
            }
        }

        // Update every 3 seconds
        setInterval(updateStats, 3000);
        updateStats(); // Initial call
    </script>

</body>

</html>